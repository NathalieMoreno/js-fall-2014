
<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <title>Instapaint</title>
    </head>

    <body>
        <div id="app">
            <form id="upload">
                <input id="photo" type="file" accept="image/*" capture="camera" />
                <input id="caption" type="text" placeholder="caption" />
                <input type="submit" value="Upload" />
            </form>
        </div>
    </body>

    <script src="jquery-2.1.1.min.js"></script>
    <script src="parse-1.3.0.min.js"></script>
    <script>
    (function() {

        Parse.initialize("anBpWcFi4tt8WN5nIFJ2T2eaRLp9rCGhxOWZohtQ", "0bKnqYCRZhCr0OorUipeh5KoFbvvWm5zpYzOkVW8");

        var Photo = Parse.Object.extend("Photo");

        var handleUploadSubmit = function(e) {
            e.preventDefault();

            var fileUploadControl = $("#photo").get(0);

            if (fileUploadControl.files.length > 0) {

                var file = fileUploadControl.files[0];
                var name = "photo.jpg";

                var photo = new Photo();
                photo.set('caption', $('#caption').val());

                var parseFile = new Parse.File(name, file);

                parseFile.save().then(function() {

                    photo.set('photo', parseFile);

                    photo.save(null, {success: function() {
                        refreshPhotos();
                    }});

                });
            }

        }

        var initializeForm = function() {
            var form = $('#upload');
            form.on('submit', handleUploadSubmit);
        }

        var startApp = function() {
            // Allow user to upload a new photo.
            initializeForm();

            // Get users recent photos with caption and title
            refreshPhotos();
            var query =  new Parse.Query(Photo);
            // If clicks on a photo, they can draw and save it.
        }

        // var currentUser = Parse.User.current();
        var currentUser = true;

        if (currentUser) {
            startApp();
        }


        })()

    </script>

</html>
